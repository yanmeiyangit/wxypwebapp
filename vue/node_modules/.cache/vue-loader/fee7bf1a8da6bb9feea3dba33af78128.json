{"remainingRequest":"/Users/mia/Documents/wxypwebapp/vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mia/Documents/wxypwebapp/vue/src/views/Collection.vue?vue&type=style&index=0&id=55026158&lang=stylus&scoped=true&","dependencies":[{"path":"/Users/mia/Documents/wxypwebapp/vue/src/views/Collection.vue","mtime":1554103443663},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.browse-warp\n    position fixed\n    top 0\n    left 0\n    right 0\n    bottom 0\n    z-index 500\n    background #fff\n    .scroll\n        position fixed\n        top 40px\n        bottom 0px\n        left 0\n        right 0\n        overflow hidden\n        \n\n",{"version":3,"sources":["Collection.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Collection.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <!-- 我的收藏 -->\n    <div class=\"browse-warp\">\n        <van-nav-bar\n            title=\"我的收藏\"\n            left-arrow\n            @click-left=\"back\"\n        />\n        <Scroll  :pullup='true' @scrollToEnd='scrollToEnd'  :data='dataArr' class=\"scroll\">\n            <div>\n                <GoodsList  :list='dataArr' :isCollection='true'  @close='close'/>\n            </div>\n            <div v-if=\"!dataArr.length\" class=\"null\">\n                 {{userName ?'暂无收藏~~' : '请先登录噢~~'}}\n            </div>\n            <div v-show=\"loading2\" class=\"van-loading van-loading--circular van-loading--white\" style=\"color: white;\"><span class=\"van-loading__spinner van-loading__spinner--circular\"><svg viewBox=\"25 25 50 50\" class=\"van-loading__circular\"><circle cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\"></circle></svg></span></div>\n        </Scroll>\n        <router-view/>\n    </div>\n</template>\n\n<script>\nimport Scroll from 'public/Scroll'\nimport GoodsList from 'public/GoodsList'\nimport {page,vuexData} from 'js/mixin'\nexport default {\n    name: 'Collection',\n    mixins: [page,vuexData],\n    components: {\n        Scroll,\n        GoodsList,\n    },\n\n    data() {\n        return {\n            list: [],\n            isText: false,\n            page: 1,\n            loading2: false,\n        }\n    },\n\n    created() {\n        this.getCollection()\n    },\n    beforeRouteUpdate (to, from, next) {\n        if (from.name == 'Details') {\n            this.getCollection()\n        }\n        next()\n        \n    },\n    methods: {\n        async getCollection(flag) {\n            if (!this.userName) {\n                this.showFlag = false\n                return\n            }\n            try {\n                if (this.isLocked()) return // 必须等待上一次请求完成\n                this.locked()//开始请求之前锁住\n                this.loading2 = true\n                const {data} = await this.Api.getCollection(this.page)\n                if (data.code == 200) {\n                    // this.showFlag = false\n                    this.loading2 = false\n                    this.setTotal(data.data.count)  // 总条数\n                    this.unLocked() // 解锁\n                    if (flag) {\n                        this.setNewData(data.data.list)\n                    } else {\n                        this.dataArr = data.data.list\n                    }\n                } else {\n                    this.isText = true\n                }\n            } catch (error) {\n                this.unLocked() // 解锁\n                this.$toast('网络错误')\n                this.loading2 = false\n            }\n        },\n        // 这里是取消收藏\n        async close(item,index) {\n            this.dataArr.splice(index,1)\n            try {\n                const {data} = await this.Api.cancelCollection(item.cid)\n                if (data.code == 200) {\n                    // this.getCollection()\n                }\n            } catch (error) {\n                this.$toast('网络错误')\n            }\n        },\n\n        // 上拉加载\n        scrollToEnd() {\n            if (this.dataArr.length >= 10) {\n                if (this.hasMore()) {\n                    this.page++\n                    this.getCollection(true)\n                } else {\n                    this.$toast('没有更多数据了~~')\n                }\n            }\n            \n        }\n    }\n}\n</script>\n\n<style lang=\"stylus\" scoped>\n.browse-warp\n    position fixed\n    top 0\n    left 0\n    right 0\n    bottom 0\n    z-index 500\n    background #fff\n    .scroll\n        position fixed\n        top 40px\n        bottom 0px\n        left 0\n        right 0\n        overflow hidden\n        \n\n</style>\n\n"]}]}