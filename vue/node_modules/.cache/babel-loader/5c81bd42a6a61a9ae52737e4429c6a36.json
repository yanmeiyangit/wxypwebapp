{"remainingRequest":"/Users/mia/Documents/wxypwebapp/vue/node_modules/babel-loader/lib/index.js!/Users/mia/Documents/wxypwebapp/vue/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/mia/Documents/wxypwebapp/vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mia/Documents/wxypwebapp/vue/src/components/my/UserInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mia/Documents/wxypwebapp/vue/src/components/my/UserInfo.vue","mtime":1554280610353},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/mia/Documents/wxypwebapp/vue/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Cropper from \"@/components/my/Cropper\";\nimport { goBack, vuexData } from \"js/mixin\";\nexport default {\n  mixins: [vuexData],\n  components: {\n    Cropper: Cropper\n  },\n  data: function data() {\n    return {\n      show: false,\n      loading: false,\n      defaultImg: 'this.src=\"' + require(\"img/vue.jpg\") + '\"',\n      imgStyle: {\n        width: \"55px\",\n        height: \"55px\",\n        \"border-radius\": \"50%\",\n        display: \"none\"\n      },\n      nickname: \"\",\n      username: \"\",\n      tempAvatar: \"\",\n      //裁剪的临时图片\n      showBirth: false,\n      showGender: false,\n      year: \"\",\n      month: \"\",\n      day: \"\",\n      gender: \"男\",\n      email: \"\",\n      currentDate: new Date(),\n      columns: [\"男\", \"女\", \"保密\"],\n      maxDate: new Date(),\n      minDate: new Date(1937, 12, 31),\n      birth: \"\" // ,出生年月\n\n    };\n  },\n  mounted: function mounted() {},\n  methods: {\n    showPop: function showPop() {\n      this.show = true;\n      this.setting();\n    },\n    goBack: function goBack() {\n      var _this = this;\n\n      this.show = false;\n      setTimeout(function () {\n        _this.tempAvatar = \"\";\n      }, 300);\n    },\n    github: function github() {\n      window.open(\"https://github.com/yanmeiyangit/wxypwebapp\", \"_blank\");\n    },\n    callback: function callback(img) {\n      this.tempAvatar = img;\n    },\n    noName: function noName() {\n      this.$toast(\"用户名暂时不能修改哟~~\");\n    },\n    // 修改用户资料\n    setting: function () {\n      var _setting = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _ref, data;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return this.Api.user();\n\n              case 3:\n                _ref = _context.sent;\n                data = _ref.data;\n\n                if (data.code == 200) {\n                  this.username = data.userInfo.username;\n                  this.gender = data.userInfo.gender;\n                  this.birth = data.userInfo.year + \"年\" + data.userInfo.month + \"月\" + data.userInfo.day + \"日\";\n                  this.year = data.userInfo.year;\n                  this.month = data.userInfo.month;\n                  this.day = data.userInfo.day;\n                  this.email = data.userInfo.email;\n                  this.id = data.userInfo._id;\n                  this.nickname = data.userInfo.nickname;\n                }\n\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                this.$toast(\"获取用户信息失败\");\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 8]]);\n      }));\n\n      function setting() {\n        return _setting.apply(this, arguments);\n      }\n\n      return setting;\n    }(),\n    confirm: function confirm(val) {\n      var d = new Date(val);\n      this.year = d.getFullYear();\n      this.month = d.getMonth() + 1;\n      this.day = d.getDate();\n      this.birth = this.year + \"年\" + this.month + \"月\" + this.day + \"日\";\n      this.showBirth = false;\n    },\n    onChange: function onChange(picker, value) {\n      this.gender = value;\n    },\n    // 保存\n    post: function () {\n      var _post = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var datas, _ref2, data;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.loading = true;\n                datas = {\n                  gender: this.gender,\n                  email: this.email,\n                  year: this.year,\n                  month: this.month,\n                  day: this.day,\n                  id: this.id,\n                  nickname: this.nickname,\n                  avatar: this.tempAvatar ? this.tempAvatar : undefined\n                };\n                _context2.prev = 2;\n                _context2.next = 5;\n                return this.Api.saveUser(datas);\n\n              case 5:\n                _ref2 = _context2.sent;\n                data = _ref2.data;\n\n                if (data.code == 200) {\n                  this.loading = false;\n                  this.setName(data.user);\n                  this.$toast(data.msg);\n                } else {\n                  this.$toast(data.msg);\n                  this.loading = false;\n                }\n\n                _context2.next = 14;\n                break;\n\n              case 10:\n                _context2.prev = 10;\n                _context2.t0 = _context2[\"catch\"](2);\n                this.loading = false;\n                this.$toast(\"修改失败,网络错误\");\n\n              case 14:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[2, 10]]);\n      }));\n\n      function post() {\n        return _post.apply(this, arguments);\n      }\n\n      return post;\n    }()\n  }\n};",{"version":3,"sources":["UserInfo.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <van-popup v-model=\"show\" position=\"right\" class=\"popup\" :overlay=\"false\">\n        <van-nav-bar title=\"个人资料\" left-arrow @click-left=\"goBack\"/>\n        <van-cell-group>\n            <p @click=\"github\">\n                <van-field\n                    class=\"border-bottom\"\n                    value=\"https://github.com/yanmeiyangit/wxypwebapp\"\n                    disabled\n                    clearable\n                    label=\"github\"\n                />\n            </p>\n            <div id=\"setAvatar\" class=\"set-avatar border-bottom\">\n                <span>头像</span>\n                <div>\n                    <img\n                        v-if=\"userName\"\n                        :onerror=\"defaultImg\"\n                        :src=\"tempAvatar || userName.avatar\"\n                        alt\n                        srcset\n                    >\n                    <van-icon name=\"arrow\"/>\n                </div>\n                <div class=\"cropper\">\n                    <Cropper :imgStyle=\"imgStyle\" @callback=\"callback\"/>\n                </div>\n            </div>\n            <p @click=\"noName\">\n                <van-field class=\"border-bottom\" v-model=\"username\" disabled clearable label=\"用户名\"/>\n            </p>\n\n            <van-field v-model=\"nickname\" clearable label=\"昵称\" placeholder=\"请输入昵称\"/>\n            <p @click=\"showGender=true\" class=\"gender\">\n                <van-field\n                    class=\"border-bottom\"\n                    v-model=\"gender\"\n                    clearable\n                    disabled\n                    label=\"性别\"\n                    placeholder=\"男\"\n                />\n            </p>\n\n            <van-field v-model=\"email\" clearable label=\"邮箱\" placeholder=\"请输入邮箱\"/>\n            <p @click=\"showBirth = true;\" class=\"birth\">\n                <van-field v-model=\"birth\" clearable disabled label=\"出生年月\" placeholder=\"出生年月\"/>\n            </p>\n        </van-cell-group>\n        <van-popup v-model=\"showBirth\" position=\"bottom\" :overlay=\"true\">\n            <van-datetime-picker\n                v-model=\"currentDate\"\n                type=\"date\"\n                :min-date=\"minDate\"\n                :max-date=\"maxDate\"\n                @confirm=\"confirm\"\n                @cancel=\"showBirth = false\"\n            />\n        </van-popup>\n        <van-popup v-model=\"showGender\" position=\"bottom\" :overlay=\"true\">\n            <van-picker\n                class=\"gender-picker\"\n                :columns=\"columns\"\n                @change=\"onChange\"\n                show-toolbar\n                title=\"性别\"\n                @cancel=\"showGender=false\"\n                @confirm=\"showGender=false\"\n            />\n        </van-popup>\n        <div class=\"normal\">\n            <van-button\n                size=\"normal\"\n                class=\"normal-btn\"\n                type=\"primary\"\n                @click=\"post\"\n                :loading=\"loading\"\n            >保存</van-button>\n            <van-button @click=\"show=false\" size=\"normal\" class=\"normal-btn normal-btn-default\">取消</van-button>\n        </div>\n    </van-popup>\n</template>\n\n<script>\nimport Cropper from \"@/components/my/Cropper\";\nimport { goBack, vuexData } from \"js/mixin\";\n\nexport default {\n    mixins: [vuexData],\n    components: {\n        Cropper\n    },\n    data() {\n        return {\n            show: false,\n            loading: false,\n            defaultImg: 'this.src=\"' + require(\"img/vue.jpg\") + '\"',\n            imgStyle: {\n                width: \"55px\",\n                height: \"55px\",\n                \"border-radius\": \"50%\",\n                display: \"none\"\n            },\n            nickname: \"\",\n            username: \"\",\n            tempAvatar: \"\", //裁剪的临时图片\n            showBirth: false,\n            showGender: false,\n            year: \"\",\n            month: \"\",\n            day: \"\",\n            gender: \"男\",\n            email: \"\",\n            currentDate: new Date(),\n            columns: [\"男\", \"女\", \"保密\"],\n            maxDate: new Date(),\n            minDate: new Date(1937, 12, 31),\n            birth: \"\" // ,出生年月\n        };\n    },\n    mounted() {\n        \n    },\n    methods: {\n        showPop() {\n            this.show = true\n            this.setting()\n        },\n        goBack() {\n            this.show = false;\n            setTimeout(() => {\n                this.tempAvatar = \"\";\n            }, 300);\n        },\n        github() {\n            window.open(\"https://github.com/yanmeiyangit/wxypwebapp\", \"_blank\");\n        },\n        callback(img) {\n            this.tempAvatar = img;\n        },\n        noName() {\n            this.$toast(\"用户名暂时不能修改哟~~\");\n        },\n        // 修改用户资料\n        async setting() {\n            try {\n                const { data } = await this.Api.user();\n                if (data.code == 200) {\n                    this.username = data.userInfo.username;\n                    this.gender = data.userInfo.gender;\n                    this.birth =\n                        data.userInfo.year +\n                        \"年\" +\n                        data.userInfo.month +\n                        \"月\" +\n                        data.userInfo.day +\n                        \"日\";\n                    this.year = data.userInfo.year;\n                    this.month = data.userInfo.month;\n                    this.day = data.userInfo.day;\n                    this.email = data.userInfo.email;\n                    this.id = data.userInfo._id;\n                    this.nickname = data.userInfo.nickname;\n                }\n            } catch (error) {\n                this.$toast(\"获取用户信息失败\");\n            }\n        },\n        confirm(val) {\n            let d = new Date(val);\n            this.year = d.getFullYear();\n            this.month = d.getMonth() + 1;\n            this.day = d.getDate();\n            this.birth = this.year + \"年\" + this.month + \"月\" + this.day + \"日\";\n            this.showBirth = false;\n        },\n\n        onChange(picker, value) {\n            this.gender = value;\n        },\n        // 保存\n        async post() {\n            this.loading = true;\n            let datas = {\n                gender: this.gender,\n                email: this.email,\n                year: this.year,\n                month: this.month,\n                day: this.day,\n                id: this.id,\n                nickname: this.nickname,\n                avatar: this.tempAvatar ? this.tempAvatar : undefined\n            };\n            try {\n                const { data } = await this.Api.saveUser(datas);\n                if (data.code == 200) {\n                    this.loading = false;\n                    this.setName(data.user);\n                    this.$toast(data.msg);\n                } else {\n                    this.$toast(data.msg);\n                    this.loading = false;\n                }\n            } catch (error) {\n                this.loading = false;\n                this.$toast(\"修改失败,网络错误\");\n            }\n        }\n    }\n};\n</script>\n\n<style scoped lang='less'>\n.popup {\n    height: 100%;\n    width: 100%;\n    background: #fff;\n}\n.normal {\n    margin-top: 50px;\n    text-align: center;\n}\n.normal-btn {\n    width: 80%;\n}\n.normal-btn-default {\n    margin-top: 10px;\n}\n.cropper {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n.set-avatar {\n    height: 80px;\n    line-height: 80px;\n    display: flex;\n    padding: 0 15px;\n    position: relative;\n    span {\n        flex: 0 0 75%;\n    }\n    div {\n        flex: 1;\n        img {\n            width: 55px;\n            height: 55px;\n            border-radius: 50%;\n            margin-right: 5px;\n        }\n    }\n}\n</style>\n\n"],"sourceRoot":"src/components/my"}]}