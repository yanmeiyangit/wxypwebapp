{"remainingRequest":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js??vue-loader-options!/Users/mia/Documents/wxypapp/Vue-shopping/vue/src/views/Evaluate.vue?vue&type=style&index=0&id=4bf54a53&lang=stylus&scoped=true&","dependencies":[{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/src/views/Evaluate.vue","mtime":1554103443663},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_css-loader@1.0.1@css-loader/index.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_vue-loader@15.7.0@vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_stylus-loader@3.0.2@stylus-loader/index.js","mtime":1519606876000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.evaluate-warp\n    position fixed\n    top 0\n    left 0\n    right 0\n    bottom 0\n    z-index 500\n    background #fff\n    .evaluateImg\n        width 100%\n        height 160px\n        object-fit cover\n    .scroll\n        position fixed\n        top 230px\n        bottom 0px\n        left 0\n        right 0\n        overflow hidden\n        .warp\n            padding 0px 10px\n            box-sizing border-box\n            .item\n                display flex\n                margin-top 15px\n                &:first-child\n                    margin-top 0\n                img \n                    width 30%\n                    flex 0 0 30%\n                    height 80px\n                    object-fit scale-down\n                    margin-right 10px\n                    border-radius 5px\n                div \n                    flex 1    \n                    display flex\n                    flex-direction column\n                    justify-content space-between\n                    padding 5px 0\n                    box-sizing border-box\n                    p\n                        line-height 1.3\n                        letter-spacing 1px\n                    .span2\n                        color #333\n                        border 1px solid #666\n                    span \n                        align-self flex-end    \n                        border 1px solid red\n                        color red\n                        padding 5px 10px\n                        border-radius 15px\n                        font-size 12px\n                        i \n                            vertical-align -1px\n                            margin-right 5px\n",{"version":3,"sources":["Evaluate.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Evaluate.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <!-- 评价 -->\n        <div class=\"evaluate-warp\">\n            <van-nav-bar\n                title=\"评价中心\"\n                left-arrow\n                @click-left=\"back\"\n            />\n            <img :src=\"evaluateImg\" class=\"evaluateImg\" alt=\"\">\n            <van-tabs v-model=\"currentActive\" >\n                <van-tab :title=\"val.title\" v-for=\"val of tabs\" :key=\"val.id\">\n                     <Scroll class=\"scroll\" v-if=\"currentActive==0\"  :data='alreadyEvaluatedList'  >\n                         <div class=\"warp\">\n                             <div class=\"item border-bottom\" v-for=\"(val,index) in evaluateList\" :key=\"index\">\n                                 <img :onerror=\"defaultImg\" :src=\"val.image_path\" alt=\"\" srcset=\"\">\n                                 <div>\n                                     <p>{{val.name}}</p>\n                                     <span @click=\"rate(val.cid,val._id,val.order_id)\"><van-icon name=\"chat\" />评论晒单</span>\n                                 </div>\n                                 \n                             </div>\n                             <h6 v-if=\"!evaluateList.length\" class=\"null\">\n                                     {{userName? '暂无待评价商品~~': '请先登录噢~~'}}\n                              </h6>\n                         </div>\n                         <div v-show=\"loading\" class=\"van-loading van-loading--circular van-loading--white\" style=\"color: white;\"><span class=\"van-loading__spinner van-loading__spinner--circular\"><svg viewBox=\"25 25 50 50\" class=\"van-loading__circular\"><circle cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\"></circle></svg></span></div>\n                     </Scroll>    \n\n\n                     <Scroll class=\"scroll\" v-if=\"currentActive==1\"  :pullup='true' :data='dataArr'  @scrollToEnd='scrollToEnd2'>\n                         <div class=\"warp\">\n                            \n                              <h6 v-if=\"!dataArr.length \" class=\"noevaluate\">\n                                    \n                                    {{userName? '暂无已评价商品~~': '请先登录'}}\n                              </h6>\n                             <div class=\"item border-bottom\" v-for=\"(val,index) in dataArr\" :key=\"index\">\n                                 <img :onerror=\"defaultImg\" :src=\"val.goods[0].image_path\" alt=\"\" srcset=\"\">\n                                 <div>\n                                     <p>{{val.goods[0].name}}</p>\n                                     <span class=\"span2\" @click=\"aevaluated(val.cid,val._id)\"><van-icon name=\"search\" />查看评价</span>\n                                 </div>\n                             </div>\n                         </div>\n                         <div v-show=\"loading2\" class=\"van-loading van-loading--circular van-loading--white\" style=\"color: white;\"><span class=\"van-loading__spinner van-loading__spinner--circular\"><svg viewBox=\"25 25 50 50\" class=\"van-loading__circular\"><circle cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\"></circle></svg></span></div>\n\n                     </Scroll>    \n                </van-tab>\n            </van-tabs>\n            \n            <!-- <Scroll v-show=\"!showFlag\" :data='list' class=\"scroll\"> -->\n                <!-- <div>\n                    <GoodsList :list='list' :isCollection='isCollection' @details='details' @close='close'/>\n                </div>\n                <div v-if=\"!list.length\" class=\"null\">\n                    {{userName&&!showFlag? '暂无收藏~~' : '请先登录噢~~'}}\n                </div> -->\n            <!-- </Scroll> -->\n            <!-- <router-view/> -->\n            <!-- <BaseLoding :showFlag='showFlag'/> -->\n        </div>\n</template>\n\n<script>\nimport Scroll from 'public/Scroll'\nimport {page,vuexData} from 'js/mixin'\nexport default {\n    name: \"Evaluate\",\n    mixins:[page,vuexData],\n    components: {\n        Scroll,\n    },\n\n    data() {\n        return {\n            evaluateImg: require('img/evaluate.jpg'),\n            currentActive:0,\n            tabs:[\n                {id:0,title: '待评价',status:0,},\n                {id:1,title: '已评价',status:1,},\n            ],\n            evaluateList: '',\n            count: 0,\n            page: 1,\n            page2:1,\n            alreadyEvaluatedList: '',\n            loading: false,\n            loading2: false,\n            defaultImg: 'this.src=\"' + require('img/vue.jpg') + '\"',\n        }\n    },\n\n    methods: {\n        // 评价\n        rate(id,_id,order_id) {\n            this.$router.push({name:'Rate',query:{id},params:{_id,order_id}})\n        },\n\n        // 查看已评价\n        aevaluated(id,_id) {\n            this.$router.push({name:'Aevaluated',query:{id:_id}})\n        },\n\n        async tobeEvaluated() {\n            try {\n                const {data} = await this.Api.tobeEvaluated(this.page1)\n                if (data.code == 200) {\n                    this.evaluateList = data.data.list\n                } else {\n                    this.loading = false\n\n                }\n            } catch (error) {\n                this.$toast('网络错误')\n            }\n        },\n\n        async alreadyEvaluated(flag) {\n            try {\n                if (this.isLocked()) return // 必须等待上一次请求完成\n                this.locked()//开始请求之前锁住\n                this.loading2 = true\n                const { data } = await this.Api.alreadyEvaluated(this.page)\n                if (data.code == 200) {\n                    this.loading2 = false\n                    this.setTotal(data.data.count)  // 总条数\n                    this.unLocked() // 解锁\n                    if (flag) {\n                        this.setNewData(data.data.list)\n                    } else {\n                        this.dataArr = data.data.list\n                    }\n                } else {\n                     this.loading2 = false\n                }\n            } catch (error) {\n                this.unLocked() // 解锁\n                this.$toast('网络错误')\n            }\n            \n        },\n\n        async scrollToEnd() {\n            \n        },\n\n        async scrollToEnd2() {\n            if (this.dataArr.length >= 10) {\n                if (this.hasMore()) {\n                this.page++\n                    this.alreadyEvaluated(true)\n                } else {\n                    this.$toast('没有很多数据了~~')\n                }\n            }\n            \n        }\n    },\n\n\n    async created() {\n        this.tobeEvaluated()\n        this.alreadyEvaluated()\n    },\n\n    beforeRouteEnter (to, from, next){\n        if (from.name === 'Rate') {\n           next(vm => {\n                vm.page = 1\n                vm.tobeEvaluated()\n                vm.alreadyEvaluated()\n            })\n        } else {\n            next()\n        }\n        \n    }\n}\n</script>\n<style lang=\"stylus\" scoped>\n.evaluate-warp\n    position fixed\n    top 0\n    left 0\n    right 0\n    bottom 0\n    z-index 500\n    background #fff\n    .evaluateImg\n        width 100%\n        height 160px\n        object-fit cover\n    .scroll\n        position fixed\n        top 230px\n        bottom 0px\n        left 0\n        right 0\n        overflow hidden\n        .warp\n            padding 0px 10px\n            box-sizing border-box\n            .item\n                display flex\n                margin-top 15px\n                &:first-child\n                    margin-top 0\n                img \n                    width 30%\n                    flex 0 0 30%\n                    height 80px\n                    object-fit scale-down\n                    margin-right 10px\n                    border-radius 5px\n                div \n                    flex 1    \n                    display flex\n                    flex-direction column\n                    justify-content space-between\n                    padding 5px 0\n                    box-sizing border-box\n                    p\n                        line-height 1.3\n                        letter-spacing 1px\n                    .span2\n                        color #333\n                        border 1px solid #666\n                    span \n                        align-self flex-end    \n                        border 1px solid red\n                        color red\n                        padding 5px 10px\n                        border-radius 15px\n                        font-size 12px\n                        i \n                            vertical-align -1px\n                            margin-right 5px\n</style>\n\n"]}]}