{"remainingRequest":"/Users/mia/Documents/wxypwebapp/vue/node_modules/babel-loader/lib/index.js!/Users/mia/Documents/wxypwebapp/vue/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/mia/Documents/wxypwebapp/vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mia/Documents/wxypwebapp/vue/src/views/Address.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mia/Documents/wxypwebapp/vue/src/views/Address.vue","mtime":1554103443661},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/mia/Documents/wxypwebapp/vue/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Scroll from 'public/Scroll';\nimport { vuexData } from 'js/mixin';\nexport default {\n  name: 'Address',\n  mixins: [vuexData],\n  components: {\n    Scroll: Scroll\n  },\n  data: function data() {\n    return {\n      chosenAddressId: '1',\n      list: [],\n      isPay: false\n    };\n  },\n  methods: {\n    onAdd: function onAdd() {\n      this.$router.push({\n        name: 'AddressEdit'\n      });\n    },\n    onEdit: function onEdit(item, index) {\n      this.setAddress(item);\n      this.$router.push({\n        name: 'AddressEdit'\n      });\n    },\n    setDefaultAddress: function () {\n      var _setDefaultAddress = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(id) {\n        var _ref, data;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return this.Api.setDefaultAddress(id);\n\n              case 3:\n                _ref = _context.sent;\n                data = _ref.data;\n\n                if (data.code == 200) {\n                  this.$toast('设置默认地址成功');\n                }\n\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                this.$toast('网络错误');\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 8]]);\n      }));\n\n      function setDefaultAddress(_x) {\n        return _setDefaultAddress.apply(this, arguments);\n      }\n\n      return setDefaultAddress;\n    }(),\n    onSelect: function onSelect(item) {\n      var _this = this;\n\n      if (this.isPay) {\n        // 判断是不是从订单页面过来的\n        this.setAddress2(item);\n        setTimeout(function () {\n          _this.$router.go(-1);\n        }, 500);\n      } else {\n        // 选中设置默认地址\n        this.setDefaultAddress(item._id);\n      }\n    }\n  },\n  created: function () {\n    var _created = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee2() {\n      var _ref2, data, defaultAddress, i;\n\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              this.showFlag = true;\n              _context2.next = 4;\n              return this.Api.getAddress();\n\n            case 4:\n              _ref2 = _context2.sent;\n              data = _ref2.data;\n\n              if (data.code == 200) {\n                this.showFlag = false;\n                this.list = data.address.reverse();\n\n                for (i = 0; i < this.list.length; i++) {\n                  if (this.list[i].isDefault == true) {\n                    defaultAddress = this.list[i];\n                    defaultAddress.id = '1';\n                    this.list.splice(i, 1);\n                    this.list.unshift(defaultAddress);\n                  } else {\n                    this.list[i].id = String(i + 2);\n                  }\n                }\n              }\n\n              _context2.next = 14;\n              break;\n\n            case 9:\n              _context2.prev = 9;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log(_context2.t0);\n              this.$toast('网络错误');\n              this.showFlag = false;\n\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this, [[0, 9]]);\n    }));\n\n    function created() {\n      return _created.apply(this, arguments);\n    }\n\n    return created;\n  }(),\n  beforeRouteEnter: function beforeRouteEnter(to, from, next) {\n    next(function (vm) {\n      if (from.name == \"ShoppingPayMent\") {\n        vm.isPay = true;\n      } // 通过 `vm` 访问组件实例\n\n    });\n  }\n};",{"version":3,"sources":["Address.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n        <div class=\"address\">\n        <van-nav-bar\n            title=\"地址列表\"\n            left-arrow\n            @click-left=\"back\"\n        />\n            <Scroll :data='list' class=\"scroll\"  v-show=\"!showFlag\">\n                <div>\n                    <van-address-list\n                        v-model=\"chosenAddressId\"\n                        :list=\"list\"\n                        @edit=\"onEdit\"\n                        @select='onSelect'\n                    />\n                </div>\n                 <div v-if=\"!list || !list.length\" class=\"nolist\">\n                    暂无收货地址~~\n                </div>\n            </Scroll>\n        <div class=\"add\" @click=\"onAdd\">新增地址</div>\n        <BaseLoding :showFlag='showFlag'/>\n        </div>\n</template>\n\n<script>\nimport Scroll from 'public/Scroll'\nimport {vuexData} from 'js/mixin'\nexport default {\n    name: 'Address',\n    mixins: [vuexData],\n    components: {\n        Scroll,\n    },\n\n    data() {\n        return {\n            chosenAddressId: '1',\n            list: [],\n            isPay: false,\n        }\n    },\n\n    methods: {\n        onAdd() {\n            this.$router.push({name: 'AddressEdit'})\n        },\n\n        onEdit(item, index) {\n            this.setAddress(item)\n            this.$router.push({name: 'AddressEdit'})\n        },\n\n        async setDefaultAddress(id) {\n            try {\n                const {data} = await this.Api.setDefaultAddress(id)\n                if (data.code == 200) {\n                    this.$toast('设置默认地址成功')\n                }\n            } catch (error) {\n                this.$toast('网络错误')\n            }\n            \n        },\n\n        onSelect(item) {\n            if (this.isPay) {   // 判断是不是从订单页面过来的\n                this.setAddress2(item)\n                setTimeout(() => {\n                    this.$router.go(-1)\n                }, 500);\n            } else {\n                // 选中设置默认地址\n                this.setDefaultAddress(item._id)                \n            }\n        },\n    },\n\n \n    async created() {\n        // 查询地址\n        try {\n            this.showFlag = true\n            const {data} = await this.Api.getAddress()\n            if (data.code == 200) {\n                this.showFlag = false\n                this.list = data.address.reverse()\n                let defaultAddress\n                for (let i = 0; i < this.list.length; i++) {\n                    if (this.list[i].isDefault == true) {\n                        defaultAddress = this.list[i]\n                        defaultAddress.id = '1'\n                        this.list.splice(i,1)\n                        this.list.unshift(defaultAddress)\n                    } else {\n                        this.list[i].id = String( i+2)\n                    }\n                }                                \n            }\n        } catch (error) {\n            console.log(error);\n            this.$toast('网络错误')\n            this.showFlag = false\n        }\n    },\n\n    beforeRouteEnter (to, from,next) {\n        next(vm => {\n            if (from.name == \"ShoppingPayMent\") {\n                vm.isPay = true\n            }\n            // 通过 `vm` 访问组件实例\n        })\n    }\n    }\n</script>\n\n<style lang=\"stylus\" scoped>\n    .address\n        position fixed\n        top 0px\n        left 0\n        right 0\n        bottom 0px\n        z-index 500\n        background #fff\n        .scroll\n            position fixed\n            top 38px\n            bottom 50px\n            left 0\n            right 0\n            overflow hidden\n            .nolist\n                text-align center\n                font-size 16px\n                letter-spacing 2px\n                color #bbb\n                margin-top 50px\n    .add\n        height 50px\n        position fixed\n        left 0\n        right 0\n        bottom 0\n        background #f44\n        color #fff    \n        text-align center\n        font-size 15px\n        letter-spacing 2px\n        line-height 50px\n        z-index 201     \n</style>\n\n"],"sourceRoot":"src/views"}]}