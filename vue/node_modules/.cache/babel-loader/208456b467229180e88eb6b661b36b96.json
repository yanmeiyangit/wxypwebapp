{"remainingRequest":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_babel-loader@8.0.5@babel-loader/lib/index.js!/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js??vue-loader-options!/Users/mia/Documents/wxypapp/Vue-shopping/vue/src/views/Evaluate.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/src/views/Evaluate.vue","mtime":1554103443663},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_babel-loader@8.0.5@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Scroll from 'public/Scroll';\nimport { page, vuexData } from 'js/mixin';\nexport default {\n  name: \"Evaluate\",\n  mixins: [page, vuexData],\n  components: {\n    Scroll: Scroll\n  },\n  data: function data() {\n    return {\n      evaluateImg: require('img/evaluate.jpg'),\n      currentActive: 0,\n      tabs: [{\n        id: 0,\n        title: '待评价',\n        status: 0\n      }, {\n        id: 1,\n        title: '已评价',\n        status: 1\n      }],\n      evaluateList: '',\n      count: 0,\n      page: 1,\n      page2: 1,\n      alreadyEvaluatedList: '',\n      loading: false,\n      loading2: false,\n      defaultImg: 'this.src=\"' + require('img/vue.jpg') + '\"'\n    };\n  },\n  methods: {\n    // 评价\n    rate: function rate(id, _id, order_id) {\n      this.$router.push({\n        name: 'Rate',\n        query: {\n          id: id\n        },\n        params: {\n          _id: _id,\n          order_id: order_id\n        }\n      });\n    },\n    // 查看已评价\n    aevaluated: function aevaluated(id, _id) {\n      this.$router.push({\n        name: 'Aevaluated',\n        query: {\n          id: _id\n        }\n      });\n    },\n    tobeEvaluated: function () {\n      var _tobeEvaluated = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _ref, data;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return this.Api.tobeEvaluated(this.page1);\n\n              case 3:\n                _ref = _context.sent;\n                data = _ref.data;\n\n                if (data.code == 200) {\n                  this.evaluateList = data.data.list;\n                } else {\n                  this.loading = false;\n                }\n\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                this.$toast('网络错误');\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 8]]);\n      }));\n\n      function tobeEvaluated() {\n        return _tobeEvaluated.apply(this, arguments);\n      }\n\n      return tobeEvaluated;\n    }(),\n    alreadyEvaluated: function () {\n      var _alreadyEvaluated = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(flag) {\n        var _ref2, data;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n\n                if (!this.isLocked()) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 3:\n                // 必须等待上一次请求完成\n                this.locked(); //开始请求之前锁住\n\n                this.loading2 = true;\n                _context2.next = 7;\n                return this.Api.alreadyEvaluated(this.page);\n\n              case 7:\n                _ref2 = _context2.sent;\n                data = _ref2.data;\n\n                if (data.code == 200) {\n                  this.loading2 = false;\n                  this.setTotal(data.data.count); // 总条数\n\n                  this.unLocked(); // 解锁\n\n                  if (flag) {\n                    this.setNewData(data.data.list);\n                  } else {\n                    this.dataArr = data.data.list;\n                  }\n                } else {\n                  this.loading2 = false;\n                }\n\n                _context2.next = 16;\n                break;\n\n              case 12:\n                _context2.prev = 12;\n                _context2.t0 = _context2[\"catch\"](0);\n                this.unLocked(); // 解锁\n\n                this.$toast('网络错误');\n\n              case 16:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[0, 12]]);\n      }));\n\n      function alreadyEvaluated(_x) {\n        return _alreadyEvaluated.apply(this, arguments);\n      }\n\n      return alreadyEvaluated;\n    }(),\n    scrollToEnd: function () {\n      var _scrollToEnd = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3() {\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function scrollToEnd() {\n        return _scrollToEnd.apply(this, arguments);\n      }\n\n      return scrollToEnd;\n    }(),\n    scrollToEnd2: function () {\n      var _scrollToEnd2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee4() {\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (this.dataArr.length >= 10) {\n                  if (this.hasMore()) {\n                    this.page++;\n                    this.alreadyEvaluated(true);\n                  } else {\n                    this.$toast('没有很多数据了~~');\n                  }\n                }\n\n              case 1:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function scrollToEnd2() {\n        return _scrollToEnd2.apply(this, arguments);\n      }\n\n      return scrollToEnd2;\n    }()\n  },\n  created: function () {\n    var _created = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee5() {\n      return regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              this.tobeEvaluated();\n              this.alreadyEvaluated();\n\n            case 2:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, this);\n    }));\n\n    function created() {\n      return _created.apply(this, arguments);\n    }\n\n    return created;\n  }(),\n  beforeRouteEnter: function beforeRouteEnter(to, from, next) {\n    if (from.name === 'Rate') {\n      next(function (vm) {\n        vm.page = 1;\n        vm.tobeEvaluated();\n        vm.alreadyEvaluated();\n      });\n    } else {\n      next();\n    }\n  }\n};",{"version":3,"sources":["Evaluate.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <!-- 评价 -->\n        <div class=\"evaluate-warp\">\n            <van-nav-bar\n                title=\"评价中心\"\n                left-arrow\n                @click-left=\"back\"\n            />\n            <img :src=\"evaluateImg\" class=\"evaluateImg\" alt=\"\">\n            <van-tabs v-model=\"currentActive\" >\n                <van-tab :title=\"val.title\" v-for=\"val of tabs\" :key=\"val.id\">\n                     <Scroll class=\"scroll\" v-if=\"currentActive==0\"  :data='alreadyEvaluatedList'  >\n                         <div class=\"warp\">\n                             <div class=\"item border-bottom\" v-for=\"(val,index) in evaluateList\" :key=\"index\">\n                                 <img :onerror=\"defaultImg\" :src=\"val.image_path\" alt=\"\" srcset=\"\">\n                                 <div>\n                                     <p>{{val.name}}</p>\n                                     <span @click=\"rate(val.cid,val._id,val.order_id)\"><van-icon name=\"chat\" />评论晒单</span>\n                                 </div>\n                                 \n                             </div>\n                             <h6 v-if=\"!evaluateList.length\" class=\"null\">\n                                     {{userName? '暂无待评价商品~~': '请先登录噢~~'}}\n                              </h6>\n                         </div>\n                         <div v-show=\"loading\" class=\"van-loading van-loading--circular van-loading--white\" style=\"color: white;\"><span class=\"van-loading__spinner van-loading__spinner--circular\"><svg viewBox=\"25 25 50 50\" class=\"van-loading__circular\"><circle cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\"></circle></svg></span></div>\n                     </Scroll>    \n\n\n                     <Scroll class=\"scroll\" v-if=\"currentActive==1\"  :pullup='true' :data='dataArr'  @scrollToEnd='scrollToEnd2'>\n                         <div class=\"warp\">\n                            \n                              <h6 v-if=\"!dataArr.length \" class=\"noevaluate\">\n                                    \n                                    {{userName? '暂无已评价商品~~': '请先登录'}}\n                              </h6>\n                             <div class=\"item border-bottom\" v-for=\"(val,index) in dataArr\" :key=\"index\">\n                                 <img :onerror=\"defaultImg\" :src=\"val.goods[0].image_path\" alt=\"\" srcset=\"\">\n                                 <div>\n                                     <p>{{val.goods[0].name}}</p>\n                                     <span class=\"span2\" @click=\"aevaluated(val.cid,val._id)\"><van-icon name=\"search\" />查看评价</span>\n                                 </div>\n                             </div>\n                         </div>\n                         <div v-show=\"loading2\" class=\"van-loading van-loading--circular van-loading--white\" style=\"color: white;\"><span class=\"van-loading__spinner van-loading__spinner--circular\"><svg viewBox=\"25 25 50 50\" class=\"van-loading__circular\"><circle cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\"></circle></svg></span></div>\n\n                     </Scroll>    \n                </van-tab>\n            </van-tabs>\n            \n            <!-- <Scroll v-show=\"!showFlag\" :data='list' class=\"scroll\"> -->\n                <!-- <div>\n                    <GoodsList :list='list' :isCollection='isCollection' @details='details' @close='close'/>\n                </div>\n                <div v-if=\"!list.length\" class=\"null\">\n                    {{userName&&!showFlag? '暂无收藏~~' : '请先登录噢~~'}}\n                </div> -->\n            <!-- </Scroll> -->\n            <!-- <router-view/> -->\n            <!-- <BaseLoding :showFlag='showFlag'/> -->\n        </div>\n</template>\n\n<script>\nimport Scroll from 'public/Scroll'\nimport {page,vuexData} from 'js/mixin'\nexport default {\n    name: \"Evaluate\",\n    mixins:[page,vuexData],\n    components: {\n        Scroll,\n    },\n\n    data() {\n        return {\n            evaluateImg: require('img/evaluate.jpg'),\n            currentActive:0,\n            tabs:[\n                {id:0,title: '待评价',status:0,},\n                {id:1,title: '已评价',status:1,},\n            ],\n            evaluateList: '',\n            count: 0,\n            page: 1,\n            page2:1,\n            alreadyEvaluatedList: '',\n            loading: false,\n            loading2: false,\n            defaultImg: 'this.src=\"' + require('img/vue.jpg') + '\"',\n        }\n    },\n\n    methods: {\n        // 评价\n        rate(id,_id,order_id) {\n            this.$router.push({name:'Rate',query:{id},params:{_id,order_id}})\n        },\n\n        // 查看已评价\n        aevaluated(id,_id) {\n            this.$router.push({name:'Aevaluated',query:{id:_id}})\n        },\n\n        async tobeEvaluated() {\n            try {\n                const {data} = await this.Api.tobeEvaluated(this.page1)\n                if (data.code == 200) {\n                    this.evaluateList = data.data.list\n                } else {\n                    this.loading = false\n\n                }\n            } catch (error) {\n                this.$toast('网络错误')\n            }\n        },\n\n        async alreadyEvaluated(flag) {\n            try {\n                if (this.isLocked()) return // 必须等待上一次请求完成\n                this.locked()//开始请求之前锁住\n                this.loading2 = true\n                const { data } = await this.Api.alreadyEvaluated(this.page)\n                if (data.code == 200) {\n                    this.loading2 = false\n                    this.setTotal(data.data.count)  // 总条数\n                    this.unLocked() // 解锁\n                    if (flag) {\n                        this.setNewData(data.data.list)\n                    } else {\n                        this.dataArr = data.data.list\n                    }\n                } else {\n                     this.loading2 = false\n                }\n            } catch (error) {\n                this.unLocked() // 解锁\n                this.$toast('网络错误')\n            }\n            \n        },\n\n        async scrollToEnd() {\n            \n        },\n\n        async scrollToEnd2() {\n            if (this.dataArr.length >= 10) {\n                if (this.hasMore()) {\n                this.page++\n                    this.alreadyEvaluated(true)\n                } else {\n                    this.$toast('没有很多数据了~~')\n                }\n            }\n            \n        }\n    },\n\n\n    async created() {\n        this.tobeEvaluated()\n        this.alreadyEvaluated()\n    },\n\n    beforeRouteEnter (to, from, next){\n        if (from.name === 'Rate') {\n           next(vm => {\n                vm.page = 1\n                vm.tobeEvaluated()\n                vm.alreadyEvaluated()\n            })\n        } else {\n            next()\n        }\n        \n    }\n}\n</script>\n<style lang=\"stylus\" scoped>\n.evaluate-warp\n    position fixed\n    top 0\n    left 0\n    right 0\n    bottom 0\n    z-index 500\n    background #fff\n    .evaluateImg\n        width 100%\n        height 160px\n        object-fit cover\n    .scroll\n        position fixed\n        top 230px\n        bottom 0px\n        left 0\n        right 0\n        overflow hidden\n        .warp\n            padding 0px 10px\n            box-sizing border-box\n            .item\n                display flex\n                margin-top 15px\n                &:first-child\n                    margin-top 0\n                img \n                    width 30%\n                    flex 0 0 30%\n                    height 80px\n                    object-fit scale-down\n                    margin-right 10px\n                    border-radius 5px\n                div \n                    flex 1    \n                    display flex\n                    flex-direction column\n                    justify-content space-between\n                    padding 5px 0\n                    box-sizing border-box\n                    p\n                        line-height 1.3\n                        letter-spacing 1px\n                    .span2\n                        color #333\n                        border 1px solid #666\n                    span \n                        align-self flex-end    \n                        border 1px solid red\n                        color red\n                        padding 5px 10px\n                        border-radius 15px\n                        font-size 12px\n                        i \n                            vertical-align -1px\n                            margin-right 5px\n</style>\n\n"],"sourceRoot":"src/views"}]}