{"remainingRequest":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js??vue-loader-options!/Users/mia/Documents/wxypapp/Vue-shopping/vue/src/views/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/src/views/Login.vue","mtime":1554103443664},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_babel-loader@8.0.5@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Back from \"public/Back\";\nimport {vuexData} from 'js/mixin'\nexport default {\n    name: \"Login\",\n    mixins: [vuexData],\n    data() {\n        return {\n            nickname:'',\n            password:'',\n            tip:'',\n            timer:0,\n            regLoding:false,\n            loginLoding: false,\n            verify: this.Api.getAverify() , \n            verifyTxt: '',\n            sms:'',\n            phone:'',\n            retry:'', // 60秒倒计时\n            dataTimer:10 // 60秒倒计时\n        }\n    },\n    components: {\n        Back,\n    },\n\n   \n    methods: {\n        // 更换验证码\n        async replaceVerify() {\n            this.$refs.eleVerify['src'] =  this.Api.getAverify()\n        },\n        login(flag) {\n            if (!this.nickname || !this.password) {\n                this.$toast('请输入用户名或者密码');\n                return\n            }\n            if (!this.verifyTxt) {\n                this.$toast('请输入验证码');\n                return\n            }\n            if (this.verifyTxt.length < 4) {\n                this.$toast('请输入正确的验证码');\n                return\n            }\n            if (!flag) {    // 登录\n                this.register(false)\n            } else {  // 注册\n                this.register(true)\n            }\n        },\n\n        async register(flag) {\n            if (flag) { //  注册\n                try {\n                    this.regLoding = true\n                    const {data} = await this.Api.register(this.nickname,this.password,this.verifyTxt)\n                    if (data.code == 200) {\n                        this.setName(data.userInfo)\n                        // this.setToken(data.token)\n                        setTimeout(() => {\n                            this.$router.go(-1)\n                        }, 1500);\n                        \n                    } else {\n                        setTimeout(() => {\n                            this.verifyTxt = ''\n                            this.replaceVerify()\n                        }, 600);\n                        \n                    }\n                    this.regLoding = false\n                    this.$toast(data.msg);\n                } catch (error) {\n                    console.log(error);\n                    \n                    this.$toast('网络错误')\n                    this.regLoding = false\n                    this.replaceVerify()\n                }\n                \n            } else {    // 登录\n                try {\n                    this.loginLoding = true\n                    const {data} = await this.Api.login(this.nickname,this.password,this.verifyTxt)\n                    if (data.code == 200) {\n                        this.setName(data.userInfo)\n                        // this.setToken(data.token)\n                        setTimeout(() => {\n                            this.$router.go(-1)\n                        }, 1500);\n                    }else {\n                       \n                       setTimeout(() => {\n                            this.verifyTxt = ''\n                            this.replaceVerify()\n                        }, 600);\n                    }\n                    this.loginLoding = false\n                    this.$toast(data.msg);\n                } catch (error) {\n                    this.$toast('网络错误')\n                    this.loginLoding = false\n                    this.replaceVerify()\n                }\n                \n                \n            }\n        },\n\n        // 发送验证码\n        async sendCode() {\n        try {\n            if (!this.phone || this.phone.length != 11 ||  !/^[1][3,4,5,7,8][0-9]{9}$/.test(this.phone)) {\n                return this.$toast('请输入正确的手机号');\n            }\n            const {data} = await this.Api.codeMsg(this.phone)\n            if (data.code == 200) {\n                this.dataTimer = 60\n                let t = setInterval(() => {\n                    if (this.dataTimer<=0) {\n                        this.retry = ''\n                        clearInterval(t)\n                        return\n                    }\n                    this.retry = this.dataTimer--\n                }, 1000);\n            } else if(data.code == -2) {\n                let t = setInterval(() => {\n                    if (data.timer<=0) {\n                        this.retry = ''\n                        clearInterval(t)\n                        this.dataTimer = 60\n                        return\n                    }\n                    this.retry = data.timer--\n                }, 1000);\n            } \n            this.$toast(data.msg);\n        } catch (error) {\n            \n        }\n            \n            \n        }\n    },\n}\n",{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA","file":"Login.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div class=\"login\" > \n        <div class=\"login-warpper\">\n            <img src=\"../assets/img/login.jpg\" alt=\"\" srcset=\"\" class=\"login-img\">\n            <div class=\"form\">\n                <div class=\"form-cont\">   \n                    <p class=\"login-title\">登录 / 注册</p>\n                    <div class=\"form-group\">\n                        <label for=\"username\" class=\"sr-only\">USERNAME</label>\n                        <input type=\"text\" v-model=\"nickname\" class=\"form-control\" maxlength=\"16\" placeholder=\"USERNAME\" autocomplete=\"off\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"password\" class=\"sr-only\">PASSWORD</label>\n                        <input type=\"password\" v-model=\"password\" class=\"form-control\" maxlength=\"16\" placeholder=\"PASSWORD\" autocomplete=\"off\">\n                    </div>\n                    <van-cell-group>\n                        <van-field\n                            v-model=\"phone\"\n                            center\n                            clearable\n                            label=\"手机号码\"\n                            placeholder=\"仅注册需要\"\n                            class=\"sms\"\n                            type='number'\n                            maxlength='11'\n                        >\n                        </van-field>\n                    </van-cell-group>\n                    <van-cell-group>\n                        <van-field\n                            v-model=\"sms\"\n                            center\n                            clearable\n                            label=\"短信验证码\"\n                            placeholder=\"仅注册需要\"\n                            class=\"sms\"\n                            maxlength='4'\n                        >\n                            <van-button slot=\"button\" size=\"small\" type=\"primary\" v-if=\"!retry\" @click=\"sendCode\">发送验证码</van-button>\n                            <van-button slot=\"button\" disabled type=\"primary\" v-else size=\"small\">{{retry}}秒后再试</van-button>\n                        </van-field>\n                    </van-cell-group>\n                    <div class=\"form-group verify\">\n                        <label for=\"inputEmail3\" class=\"col-sm-2 control-label\">验证码</label>\n                        <input type=\"text\" placeholder=\"请输入验证码\" v-model=\"verifyTxt\"  class=\"form-control verify-input\" maxlength=\"4\"  autocomplete=\"off\">\n                        <div class=\"col-sm-10\">\n                            <img :src=\"verify\" ref=\"eleVerify\" @click=\"replaceVerify\" title=\"看不清？点击刷新\">\n                        </div>\n                    </div>\n\n                    <div class=\"form-group form-group2\">\n                        <van-button :loading='loginLoding' style=\"margin-right:10px\" type=\"primary\" @click=\"login(false)\">登 录</van-button>\n                        <van-button :loading='regLoding'  type=\"danger\" @click=\"login(true)\" >注 册</van-button>\n                    </div>\n                </div>\n            </div>\n            <Back @back='back'/>\n    </div>\n    </div>\n</template>\n\n<script>\nimport Back from \"public/Back\";\nimport {vuexData} from 'js/mixin'\nexport default {\n    name: \"Login\",\n    mixins: [vuexData],\n    data() {\n        return {\n            nickname:'',\n            password:'',\n            tip:'',\n            timer:0,\n            regLoding:false,\n            loginLoding: false,\n            verify: this.Api.getAverify() , \n            verifyTxt: '',\n            sms:'',\n            phone:'',\n            retry:'', // 60秒倒计时\n            dataTimer:10 // 60秒倒计时\n        }\n    },\n    components: {\n        Back,\n    },\n\n   \n    methods: {\n        // 更换验证码\n        async replaceVerify() {\n            this.$refs.eleVerify['src'] =  this.Api.getAverify()\n        },\n        login(flag) {\n            if (!this.nickname || !this.password) {\n                this.$toast('请输入用户名或者密码');\n                return\n            }\n            if (!this.verifyTxt) {\n                this.$toast('请输入验证码');\n                return\n            }\n            if (this.verifyTxt.length < 4) {\n                this.$toast('请输入正确的验证码');\n                return\n            }\n            if (!flag) {    // 登录\n                this.register(false)\n            } else {  // 注册\n                this.register(true)\n            }\n        },\n\n        async register(flag) {\n            if (flag) { //  注册\n                try {\n                    this.regLoding = true\n                    const {data} = await this.Api.register(this.nickname,this.password,this.verifyTxt)\n                    if (data.code == 200) {\n                        this.setName(data.userInfo)\n                        // this.setToken(data.token)\n                        setTimeout(() => {\n                            this.$router.go(-1)\n                        }, 1500);\n                        \n                    } else {\n                        setTimeout(() => {\n                            this.verifyTxt = ''\n                            this.replaceVerify()\n                        }, 600);\n                        \n                    }\n                    this.regLoding = false\n                    this.$toast(data.msg);\n                } catch (error) {\n                    console.log(error);\n                    \n                    this.$toast('网络错误')\n                    this.regLoding = false\n                    this.replaceVerify()\n                }\n                \n            } else {    // 登录\n                try {\n                    this.loginLoding = true\n                    const {data} = await this.Api.login(this.nickname,this.password,this.verifyTxt)\n                    if (data.code == 200) {\n                        this.setName(data.userInfo)\n                        // this.setToken(data.token)\n                        setTimeout(() => {\n                            this.$router.go(-1)\n                        }, 1500);\n                    }else {\n                       \n                       setTimeout(() => {\n                            this.verifyTxt = ''\n                            this.replaceVerify()\n                        }, 600);\n                    }\n                    this.loginLoding = false\n                    this.$toast(data.msg);\n                } catch (error) {\n                    this.$toast('网络错误')\n                    this.loginLoding = false\n                    this.replaceVerify()\n                }\n                \n                \n            }\n        },\n\n        // 发送验证码\n        async sendCode() {\n        try {\n            if (!this.phone || this.phone.length != 11 ||  !/^[1][3,4,5,7,8][0-9]{9}$/.test(this.phone)) {\n                return this.$toast('请输入正确的手机号');\n            }\n            const {data} = await this.Api.codeMsg(this.phone)\n            if (data.code == 200) {\n                this.dataTimer = 60\n                let t = setInterval(() => {\n                    if (this.dataTimer<=0) {\n                        this.retry = ''\n                        clearInterval(t)\n                        return\n                    }\n                    this.retry = this.dataTimer--\n                }, 1000);\n            } else if(data.code == -2) {\n                let t = setInterval(() => {\n                    if (data.timer<=0) {\n                        this.retry = ''\n                        clearInterval(t)\n                        this.dataTimer = 60\n                        return\n                    }\n                    this.retry = data.timer--\n                }, 1000);\n            } \n            this.$toast(data.msg);\n        } catch (error) {\n            \n        }\n            \n            \n        }\n    },\n}\n</script>\n\n<style lang=\"stylus\" scoped>\n.login-warpper >>> .van-cell--center \n    padding-left 0\n    border-bottom: 1px solid rgba(0,0,0,.1);\n.login-warpper >>> .van-hairline--top-bottom:after\n    border 0\n.login-warpper >>> .van-field__control::-webkit-input-placeholder\n    color: #D8D8D8\n    font-size 15px    \n.login\n    height 100%\n    background #EFEFEF\n    overflow hidden\n    position fixed\n    top 0\n    left 0\n    right 0\n    bottom 0\n    z-index 100\n    .login-warpper\n        z-index 10\n        .login-img\n            width 100%\n            height 100%\n        .form\n            width 90%\n            margin 0 auto\n            background #fff\n            position absolute\n            top 17%\n            left 50%\n            transform translateX(-50%)\n            padding: 7px\n            box-shadow: -2px 3px 23px 1px rgba(0, 0, 0, 0.1)\n            .form-cont\n                padding 8px\n                .login-title\n                    letter-spacing: 1px;\n                    font-size: 20px;\n                    margin: 0 0 30px 0;\n                    color: #000000;\n                .form-group\n                    margin-bottom: 30px\n                    .van-button\n                        height 45px\n                        line-height 45px\n                        font-size 14px\n                        padding 0 15px\n                        width 100px\n                    .sr-only\n                        position: absolute;\n                        width: 1px;\n                        height: 1px;\n                        padding: 0;\n                        margin: -1px;\n                        overflow: hidden;\n                        clip: rect(0,0,0,0);\n                        border: 0;    \n                        font-size: 14px;\n                        font-weight: 300;\n                        font-family: \"Open Sans\", Arial, sans-serif!important\n                    \n\n                    .form-control\n                        font-size: 16px\n                        font-weight: 300\n                        width 100%\n                        display block\n                        height: 50px\n                        padding-left: 0\n                        padding-right: 0\n                        border: none\n                        border-bottom: 1px solid rgba(0, 0, 0, 0.1)\n                        -webkit-box-shadow: none\n                        -moz-box-shadow: none\n                        -o-box-shadow: none\n                        box-shadow: none\n                        -webkit-border-radius: 0px\n                        -moz-border-radius: 0px\n                        -ms-border-radius: 0px\n                        border-radius: 0px\n                        -moz-transition: all 0.3s ease\n                        -o-transition: all 0.3s ease\n                        -webkit-transition: all 0.3s ease\n                        -ms-transition: all 0.3s ease\n                        transition: all 0.3s ease\n                        font-family: \"Open Sans\", Arial, sans-serif!important\n                        color: #555;\n                        &:focus\n                            border-bottom: 1px solid rgba(0, 0, 0, 0.4) \n                    input::-webkit-input-placeholder\n                        color: #D8D8D8\n                        font-size 15px\n                    .btn-primary\n                        height: 50px;\n                        padding-right: 20px;\n                        padding-left: 20px;\n                        border: none;\n                        background: #33cccc;\n                        color: #ffffff;\n                        box-shadow: -1px 5px 10px -1px rgba(51, 204, 204, 0.4);\n                        display: inline-block;\n                        padding: 6px 12px;\n                        margin-bottom: 0;\n                        font-size: 14px;\n                        font-weight: 400;\n                        line-height: 1.42857143;\n                        text-align: center;\n                        white-space: nowrap;\n                        vertical-align: middle;\n                        display: inline-block;\n                        padding: 6px 14px;\n                        margin-bottom: 0;\n                        font-size: 14px;\n                        font-weight: 400;\n                        line-height: 1.42857143;\n                        text-align: center;\n                        white-space: nowrap;\n                        vertical-align: middle;\n                        -ms-touch-action: manipulation;\n                        touch-action: manipulation;\n                        cursor: pointer;\n                        -webkit-user-select: none;\n                        -moz-user-select: none;\n                        -ms-user-select: none;\n                        user-select: none;\n                        background-image: none;\n                        border: 1px solid transparent;\n                        border-radius: 4px;\n                        &:active,&:focus,&:hover\n                            color: #ffffff;\n                            background: #47d1d1 !important;\n                            outline: none;\n                            border-color: #122b40;\n                            box-shadow: inset 0 1.5px 2.5px rgba(0,0,0,.125);\n                    .reg\n                        box-shadow: -1px 5px 10px -1px rgba(255, 0, 128, 0.4);       \n                .verify\n                    display flex\n                    align-items center\n                    margin-top 20px\n                    label\n                        flex 0 0 20% \n                    .verify-input\n                        flex 0 0 45%\n                        margin-right 5%\n                        height 40px\n                    .col-sm-10\n                        flex 1        \n\n        \n                    \n</style>\n\n"]}]}