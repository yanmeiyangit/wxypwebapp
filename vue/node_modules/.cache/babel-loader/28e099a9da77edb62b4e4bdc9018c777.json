{"remainingRequest":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_babel-loader@8.0.5@babel-loader/lib/index.js!/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js??vue-loader-options!/Users/mia/Documents/wxypapp/Vue-shopping/vue/src/views/Rate.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/src/views/Rate.vue","mtime":1554103443664},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_babel-loader@8.0.5@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Upload from \"@/components/rate/Upload\";\nimport { vuexData } from 'js/mixin';\nexport default {\n  name: \"Rate\",\n  mixins: [vuexData],\n  props: [\"id\"],\n  data: function data() {\n    return {\n      rate: 5,\n      message: \"\",\n      checked: false,\n      goodsOne: \"\",\n      _id: \"\",\n      // 数据库单条id\n      order_id: \"\",\n      //  订单id\n      imgList: [] //已上传的图片集合\n\n    };\n  },\n  components: {\n    Upload: Upload\n  },\n  methods: {\n    submit: function () {\n      var _submit = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        var datas, _ref, data;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (this.message) {\n                  _context.next = 2;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", this.$toast(\"请输入需要提交的内容\"));\n\n              case 2:\n                datas = {\n                  id: this.id,\n                  rate: this.rate,\n                  content: this.message,\n                  anonymous: this.checked,\n                  _id: this._id,\n                  order_id: this.order_id,\n                  image: this.imgList\n                };\n                _context.next = 5;\n                return this.Api.comment(datas);\n\n              case 5:\n                _ref = _context.sent;\n                data = _ref.data;\n\n                if (data.code == 200) {\n                  this.$toast(data.msg);\n                  setTimeout(function () {\n                    _this.message = \"\";\n\n                    _this.$router.go(-1);\n\n                    _this.imgList = [];\n\n                    _this.$refs.upload.clearFiles();\n                  }, 1500);\n                }\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function submit() {\n        return _submit.apply(this, arguments);\n      }\n\n      return submit;\n    }(),\n    getImageList: function getImageList(files) {\n      var _this2 = this;\n\n      this.$nextTick(function () {\n        for (var i = 0, len = files.length; i < len; i++) {\n          _this2.imgList.push(files[i].src.split(\"base64,\")[1]);\n        }\n      });\n    },\n    //删除图片\n    removeImage: function removeImage(index) {\n      this.imgList.splice(index, 1);\n    }\n  },\n  created: function () {\n    var _created = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee2() {\n      var _ref2, data;\n\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              this._id = this.$route.params._id;\n              this.order_id = this.$route.params.order_id;\n              _context2.prev = 2;\n              _context2.next = 5;\n              return this.Api.goodOne(this.id);\n\n            case 5:\n              _ref2 = _context2.sent;\n              data = _ref2.data;\n\n              if (data.code == 200) {\n                this.goodsOne = data.goods.goodsOne;\n              } else {\n                this.$toast(\"请先登录\");\n              }\n\n              _context2.next = 13;\n              break;\n\n            case 10:\n              _context2.prev = 10;\n              _context2.t0 = _context2[\"catch\"](2);\n              this.$toast(\"网络错误\");\n\n            case 13:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this, [[2, 10]]);\n    }));\n\n    function created() {\n      return _created.apply(this, arguments);\n    }\n\n    return created;\n  }()\n};",{"version":3,"sources":["Rate.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <!-- 商品评论 -->\n    <div class=\"rate-warp\">\n        <van-nav-bar title=\"评价中心\" left-arrow @click-left=\"back\"/>\n        <div class=\"goods\">\n            <img :src=\"goodsOne.image_path\" alt srcset>\n            <div>\n                <p class=\"rate-txt\">商品评分</p>\n                <p class=\"rate\">\n                    <van-rate color=\"#e0322b\" v-model=\"rate\"/>\n                </p>\n            </div>\n        </div>\n        <div>\n            <van-cell-group>\n                <van-field\n                    v-model=\"message\"\n                    type=\"textarea\"\n                    placeholder=\"说说你的购买感受吧~~\"\n                    rows=\"6\"\n                    autosize\n                    maxlength=\"120\"\n                />\n            </van-cell-group>\n            <Upload @getFiles=\"getImageList\" @removeFiles=\"removeImage\" ref=\"upload\"/>\n        </div>\n        <div class=\"checkbox\">\n            <van-checkbox v-model=\"checked\" checked-color=\"#e0322b\">匿名评价</van-checkbox>\n        </div>\n        <div class=\"btn\">\n            <van-button type=\"primary\" size=\"large\" @click=\"submit\">提交</van-button>\n        </div>\n        <!-- <van-uploader :after-read=\"onRead\">\n            <van-icon name=\"photograph\" />\n        </van-uploader>-->\n    </div>\n</template>\n\n<script>\nimport Upload from \"@/components/rate/Upload\";\nimport {vuexData} from 'js/mixin'\nexport default {\n    name: \"Rate\",\n    mixins:[vuexData],\n    props: [\"id\"],\n    data() {\n        return {\n            rate: 5,\n            message: \"\",\n            checked: false,\n            goodsOne: \"\",\n            _id: \"\", // 数据库单条id\n            order_id: \"\", //  订单id\n            imgList: [], //已上传的图片集合\n        };\n    },\n\n    components: {\n        Upload\n    },\n    methods: {\n\n        async submit() {\n            // console.log(this.imgList);\n            if (!this.message) {\n                return this.$toast(\"请输入需要提交的内容\");\n            }\n            const datas = {\n                id: this.id,\n                rate: this.rate,\n                content: this.message,\n                anonymous: this.checked,\n                _id: this._id,\n                order_id: this.order_id,\n                image: this.imgList\n            };\n            const { data } = await this.Api.comment(datas);\n            if (data.code == 200) {\n                this.$toast(data.msg);\n                \n                setTimeout(() => {\n                    this.message = \"\";\n                    this.$router.go(-1);\n                    this.imgList = []\n                    this.$refs.upload.clearFiles()\n                }, 1500);\n            }\n        },\n        getImageList(files) {\n            this.$nextTick(() => {\n                for (let i = 0, len = files.length; i < len; i++) {\n                    this.imgList.push(files[i].src.split(\"base64,\")[1]);\n                }\n            });\n        },\n        //删除图片\n        removeImage(index) {\n            this.imgList.splice(index, 1);\n        }\n    },\n\n    async created() {\n        this._id = this.$route.params._id;\n        this.order_id = this.$route.params.order_id;\n        try {\n            const { data } = await this.Api.goodOne(this.id);\n            if (data.code == 200) {\n                this.goodsOne = data.goods.goodsOne;\n            } else {\n                this.$toast(\"请先登录\");\n            }\n        } catch (error) {\n            this.$toast(\"网络错误\");\n        }\n    }\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n.rate-warp {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 500;\n    background: #fff;\n\n    .goods {\n        display: flex;\n        padding-top: 10px;\n\n        img {\n            width: 30%;\n            height: 80px;\n            flex: 0 0 30%;\n            object-fit: scale-down;\n            margin-right: 10px;\n            border-radius: 5px;\n        }\n\n        div {\n            flex: 1;\n            display: flex;\n            flex-direction: column;\n\n            .rate-txt {\n                margin-top: 10px;\n            }\n\n            .rate {\n                margin-top: 20px;\n            }\n\n            .van-rate {\n                display: flex;\n                flex-direction: row;\n            }\n        }\n    }\n\n    .btn {\n        width: 90%;\n        margin: 30px auto;\n    }\n\n    .checkbox {\n        padding-left: 15px;\n    }\n}\n</style>\n\n"],"sourceRoot":"src/views"}]}