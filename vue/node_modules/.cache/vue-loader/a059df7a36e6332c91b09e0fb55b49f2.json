{"remainingRequest":"/Users/mia/Documents/wxypwebapp/vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mia/Documents/wxypwebapp/vue/src/views/Address.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mia/Documents/wxypwebapp/vue/src/views/Address.vue","mtime":1554103443661},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypwebapp/vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Scroll from 'public/Scroll'\nimport {vuexData} from 'js/mixin'\nexport default {\n    name: 'Address',\n    mixins: [vuexData],\n    components: {\n        Scroll,\n    },\n\n    data() {\n        return {\n            chosenAddressId: '1',\n            list: [],\n            isPay: false,\n        }\n    },\n\n    methods: {\n        onAdd() {\n            this.$router.push({name: 'AddressEdit'})\n        },\n\n        onEdit(item, index) {\n            this.setAddress(item)\n            this.$router.push({name: 'AddressEdit'})\n        },\n\n        async setDefaultAddress(id) {\n            try {\n                const {data} = await this.Api.setDefaultAddress(id)\n                if (data.code == 200) {\n                    this.$toast('设置默认地址成功')\n                }\n            } catch (error) {\n                this.$toast('网络错误')\n            }\n            \n        },\n\n        onSelect(item) {\n            if (this.isPay) {   // 判断是不是从订单页面过来的\n                this.setAddress2(item)\n                setTimeout(() => {\n                    this.$router.go(-1)\n                }, 500);\n            } else {\n                // 选中设置默认地址\n                this.setDefaultAddress(item._id)                \n            }\n        },\n    },\n\n \n    async created() {\n        // 查询地址\n        try {\n            this.showFlag = true\n            const {data} = await this.Api.getAddress()\n            if (data.code == 200) {\n                this.showFlag = false\n                this.list = data.address.reverse()\n                let defaultAddress\n                for (let i = 0; i < this.list.length; i++) {\n                    if (this.list[i].isDefault == true) {\n                        defaultAddress = this.list[i]\n                        defaultAddress.id = '1'\n                        this.list.splice(i,1)\n                        this.list.unshift(defaultAddress)\n                    } else {\n                        this.list[i].id = String( i+2)\n                    }\n                }                                \n            }\n        } catch (error) {\n            console.log(error);\n            this.$toast('网络错误')\n            this.showFlag = false\n        }\n    },\n\n    beforeRouteEnter (to, from,next) {\n        next(vm => {\n            if (from.name == \"ShoppingPayMent\") {\n                vm.isPay = true\n            }\n            // 通过 `vm` 访问组件实例\n        })\n    }\n    }\n",{"version":3,"sources":["Address.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Address.vue","sourceRoot":"src/views","sourcesContent":["<template>\n        <div class=\"address\">\n        <van-nav-bar\n            title=\"地址列表\"\n            left-arrow\n            @click-left=\"back\"\n        />\n            <Scroll :data='list' class=\"scroll\"  v-show=\"!showFlag\">\n                <div>\n                    <van-address-list\n                        v-model=\"chosenAddressId\"\n                        :list=\"list\"\n                        @edit=\"onEdit\"\n                        @select='onSelect'\n                    />\n                </div>\n                 <div v-if=\"!list || !list.length\" class=\"nolist\">\n                    暂无收货地址~~\n                </div>\n            </Scroll>\n        <div class=\"add\" @click=\"onAdd\">新增地址</div>\n        <BaseLoding :showFlag='showFlag'/>\n        </div>\n</template>\n\n<script>\nimport Scroll from 'public/Scroll'\nimport {vuexData} from 'js/mixin'\nexport default {\n    name: 'Address',\n    mixins: [vuexData],\n    components: {\n        Scroll,\n    },\n\n    data() {\n        return {\n            chosenAddressId: '1',\n            list: [],\n            isPay: false,\n        }\n    },\n\n    methods: {\n        onAdd() {\n            this.$router.push({name: 'AddressEdit'})\n        },\n\n        onEdit(item, index) {\n            this.setAddress(item)\n            this.$router.push({name: 'AddressEdit'})\n        },\n\n        async setDefaultAddress(id) {\n            try {\n                const {data} = await this.Api.setDefaultAddress(id)\n                if (data.code == 200) {\n                    this.$toast('设置默认地址成功')\n                }\n            } catch (error) {\n                this.$toast('网络错误')\n            }\n            \n        },\n\n        onSelect(item) {\n            if (this.isPay) {   // 判断是不是从订单页面过来的\n                this.setAddress2(item)\n                setTimeout(() => {\n                    this.$router.go(-1)\n                }, 500);\n            } else {\n                // 选中设置默认地址\n                this.setDefaultAddress(item._id)                \n            }\n        },\n    },\n\n \n    async created() {\n        // 查询地址\n        try {\n            this.showFlag = true\n            const {data} = await this.Api.getAddress()\n            if (data.code == 200) {\n                this.showFlag = false\n                this.list = data.address.reverse()\n                let defaultAddress\n                for (let i = 0; i < this.list.length; i++) {\n                    if (this.list[i].isDefault == true) {\n                        defaultAddress = this.list[i]\n                        defaultAddress.id = '1'\n                        this.list.splice(i,1)\n                        this.list.unshift(defaultAddress)\n                    } else {\n                        this.list[i].id = String( i+2)\n                    }\n                }                                \n            }\n        } catch (error) {\n            console.log(error);\n            this.$toast('网络错误')\n            this.showFlag = false\n        }\n    },\n\n    beforeRouteEnter (to, from,next) {\n        next(vm => {\n            if (from.name == \"ShoppingPayMent\") {\n                vm.isPay = true\n            }\n            // 通过 `vm` 访问组件实例\n        })\n    }\n    }\n</script>\n\n<style lang=\"stylus\" scoped>\n    .address\n        position fixed\n        top 0px\n        left 0\n        right 0\n        bottom 0px\n        z-index 500\n        background #fff\n        .scroll\n            position fixed\n            top 38px\n            bottom 50px\n            left 0\n            right 0\n            overflow hidden\n            .nolist\n                text-align center\n                font-size 16px\n                letter-spacing 2px\n                color #bbb\n                margin-top 50px\n    .add\n        height 50px\n        position fixed\n        left 0\n        right 0\n        bottom 0\n        background #f44\n        color #fff    \n        text-align center\n        font-size 15px\n        letter-spacing 2px\n        line-height 50px\n        z-index 201     \n</style>\n\n"]}]}