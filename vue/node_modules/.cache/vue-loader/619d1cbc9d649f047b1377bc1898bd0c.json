{"remainingRequest":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js??vue-loader-options!/Users/mia/Documents/wxypapp/Vue-shopping/vue/src/views/City.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/src/views/City.vue","mtime":1554103443662},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_babel-loader@8.0.5@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mia/Documents/wxypapp/Vue-shopping/vue/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport CityRight from \"@/components/city/CityRight\";\nimport Scroll from \"public/Scroll\";\nimport city from \"js/city\";\nimport { throttle } from \"js/util\";\nimport { vuexData } from \"js/mixin\";\n\nexport default {\n    name: \"City\",\n    mixins: [vuexData],\n    components: {\n        Scroll,\n        CityRight\n    },\n\n    data() {\n        return {\n            citys: city,\n            touchStatus: false,\n            citiTxt: \"\",\n            listenScroll: true, //监听scroll的滚动事件\n            probeType: 3, //滚动不节流\n            heightArr: [], // 用来装每个区间的高度\n            scrollY: -1,\n            fixedTitle: \"当前城市\",\n            diff: -1,\n            cityList: [],\n            keyword: \"\"\n        };\n    },\n\n    computed: {\n        citiesList() {\n            let arr = [];\n            for (let k in city.data.cities) {\n                arr.push(k);\n            }\n            return arr;\n        },\n\n        letter() {\n            let arr = [];\n            for (let k in this.citys.data.cities) {\n                arr.push(k);\n            }\n            return arr;\n        },\n\n        noData() {\n            return !this.cityList.length;\n        }\n    },\n\n    methods: {\n        onSearch() {},\n\n        selectCiti(val) {\n            this.selectCity(val);\n            this.back();\n        },\n\n        change(txt) {\n            this.citiTxt = txt;\n        },\n\n        scroll(e) {\n            this.scrollY = e.y;\n        },\n\n        //计算每个区间的高度\n        listHeight() {\n            //计算每个区间的高度\n            let height =\n                this.$refs.currentCity.clientHeight +\n                this.$refs.hotCity.clientHeight;\n            this.heightArr.push(height);\n            for (let k in this.$refs) {\n                if (this.$refs[k][0]) {\n                    let item = this.$refs[k][0];\n                    height += item.clientHeight;\n                    this.heightArr.push(height);\n                }\n            }\n        },\n\n        // 城市搜索\n        searchCity() {\n            let arr = [];\n            for (const k in city.data.cities) {\n                city.data.cities[k].forEach(item => {\n                    if (\n                        item.spell.includes(this.keyword) ||\n                        item.name.includes(this.keyword)\n                    ) {\n                        arr.push(item);\n                    }\n                });\n            }\n            this.cityList = arr;\n        }\n    },\n\n    mounted() {\n        this.listHeight();\n    },\n    watch: {\n        keyword() {\n            throttle(this.searchCity(), 300, 500);\n        },\n\n        citiTxt() {\n            if (this.citiTxt) {\n                const element = this.$refs[this.citiTxt][0];\n                this.$refs.scroll.scrollToElement(element, 200);\n            }\n        },\n        scrollY(newY) {\n            if (newY > 0) {\n                this.fixedTitle = \"\";\n            }\n            let heightArr = this.heightArr;\n            for (let i = 0; i < heightArr.length; i++) {\n                let height1 = heightArr[i];\n                let height2 = heightArr[i + 1];\n\n                if (-newY >= height1 && -newY < height2) {\n                    if (this.letter[i]) {\n                        this.fixedTitle = this.letter[i];\n                        this.diff = height2 + newY;\n                    }\n                    return;\n                }\n            }\n        },\n        diff(newVal) {\n            let fixedTop = newVal > 0 && newVal < 30 ? newVal - 30 : 0;\n            if (this.fixedTop === fixedTop) {\n                return;\n            }\n            this.fixedTop = fixedTop;\n            this.$refs.fixed.style.transform = `translate3d(0,${fixedTop}px,0)`;\n        }\n    }\n};\n",{"version":3,"sources":["City.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"City.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div class=\"city-warp\">\n        <van-nav-bar title=\"城市列表\" left-arrow @click-left=\"back\"/>\n        <div class=\"serach\">\n            <van-col span=\"24\">\n                <van-search placeholder=\"请输入城市关键字\" v-model=\"keyword\"/>\n            </van-col>\n        </div>\n        <Scroll\n            class=\"scroll\"\n            v-show=\"!keyword\"\n            ref=\"scroll\"\n            :listenScroll=\"listenScroll\"\n            :probeType=\"probeType\"\n            @scroll=\"scroll\"\n        >\n            <div>\n                <div class=\"area\" ref=\"currentCity\">\n                    <div class=\"title\">当前城市</div>\n                    <div class=\"button-list\">\n                        <div class=\"button-warpper\">\n                            <div class=\"button\">{{city}}</div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"area\" ref=\"hotCity\">\n                    <div class=\"title border-topbottom\">热门城市</div>\n                    <div class=\"button-list\">\n                        <div\n                            class=\"button-warpper\"\n                            v-for=\"val in citys.data.hotCities\"\n                            :key=\"val.id\"\n                        >\n                            <div class=\"button\" @click=\"selectCiti(val.name)\">{{val.name}}</div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"area2\" v-for=\"(val,key) of citys.data.cities\" :key=\"key\" :ref=\"key\">\n                    <div class=\"title border-topbottom\">{{key}}</div>\n                    <div class=\"item-list\" v-for=\"item in val\" :key=\"item.id\">\n                        <div class=\"item border-bottom\" @click=\"selectCiti(item.name)\">{{item.name}}</div>\n                    </div>\n                </div>\n            </div>\n            <div class=\"list-fixed\" v-show=\"fixedTitle\" ref=\"fixed\">\n                <h1 class=\"fixed-title\">{{fixedTitle}}</h1>\n            </div>\n        </Scroll>\n        <Scroll :data=\"cityList\" class=\"search-content\" v-show=\"keyword\" ref=\"search\">\n            <ul>\n                <li\n                    v-for=\"(val,index) in cityList\"\n                    :key=\"index\"\n                    @click=\"selectCiti(val.name)\"\n                    class=\"border-bottom\"\n                >{{val.name}}</li>\n            </ul>\n            <div v-show=\"noData\" class=\"noData\">暂时没有数据~~</div>\n        </Scroll>\n\n        <CityRight v-show=\"!keyword\" @change=\"change\" :cities=\"citys.data.cities\"/>\n    </div>\n</template>\n\n<script>\nimport CityRight from \"@/components/city/CityRight\";\nimport Scroll from \"public/Scroll\";\nimport city from \"js/city\";\nimport { throttle } from \"js/util\";\nimport { vuexData } from \"js/mixin\";\n\nexport default {\n    name: \"City\",\n    mixins: [vuexData],\n    components: {\n        Scroll,\n        CityRight\n    },\n\n    data() {\n        return {\n            citys: city,\n            touchStatus: false,\n            citiTxt: \"\",\n            listenScroll: true, //监听scroll的滚动事件\n            probeType: 3, //滚动不节流\n            heightArr: [], // 用来装每个区间的高度\n            scrollY: -1,\n            fixedTitle: \"当前城市\",\n            diff: -1,\n            cityList: [],\n            keyword: \"\"\n        };\n    },\n\n    computed: {\n        citiesList() {\n            let arr = [];\n            for (let k in city.data.cities) {\n                arr.push(k);\n            }\n            return arr;\n        },\n\n        letter() {\n            let arr = [];\n            for (let k in this.citys.data.cities) {\n                arr.push(k);\n            }\n            return arr;\n        },\n\n        noData() {\n            return !this.cityList.length;\n        }\n    },\n\n    methods: {\n        onSearch() {},\n\n        selectCiti(val) {\n            this.selectCity(val);\n            this.back();\n        },\n\n        change(txt) {\n            this.citiTxt = txt;\n        },\n\n        scroll(e) {\n            this.scrollY = e.y;\n        },\n\n        //计算每个区间的高度\n        listHeight() {\n            //计算每个区间的高度\n            let height =\n                this.$refs.currentCity.clientHeight +\n                this.$refs.hotCity.clientHeight;\n            this.heightArr.push(height);\n            for (let k in this.$refs) {\n                if (this.$refs[k][0]) {\n                    let item = this.$refs[k][0];\n                    height += item.clientHeight;\n                    this.heightArr.push(height);\n                }\n            }\n        },\n\n        // 城市搜索\n        searchCity() {\n            let arr = [];\n            for (const k in city.data.cities) {\n                city.data.cities[k].forEach(item => {\n                    if (\n                        item.spell.includes(this.keyword) ||\n                        item.name.includes(this.keyword)\n                    ) {\n                        arr.push(item);\n                    }\n                });\n            }\n            this.cityList = arr;\n        }\n    },\n\n    mounted() {\n        this.listHeight();\n    },\n    watch: {\n        keyword() {\n            throttle(this.searchCity(), 300, 500);\n        },\n\n        citiTxt() {\n            if (this.citiTxt) {\n                const element = this.$refs[this.citiTxt][0];\n                this.$refs.scroll.scrollToElement(element, 200);\n            }\n        },\n        scrollY(newY) {\n            if (newY > 0) {\n                this.fixedTitle = \"\";\n            }\n            let heightArr = this.heightArr;\n            for (let i = 0; i < heightArr.length; i++) {\n                let height1 = heightArr[i];\n                let height2 = heightArr[i + 1];\n\n                if (-newY >= height1 && -newY < height2) {\n                    if (this.letter[i]) {\n                        this.fixedTitle = this.letter[i];\n                        this.diff = height2 + newY;\n                    }\n                    return;\n                }\n            }\n        },\n        diff(newVal) {\n            let fixedTop = newVal > 0 && newVal < 30 ? newVal - 30 : 0;\n            if (this.fixedTop === fixedTop) {\n                return;\n            }\n            this.fixedTop = fixedTop;\n            this.$refs.fixed.style.transform = `translate3d(0,${fixedTop}px,0)`;\n        }\n    }\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n.city-warp {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 500;\n    background: #fff;\n\n    .scroll {\n        position: fixed;\n        top: 83px;\n        bottom: 0px;\n        left: 0;\n        right: 0;\n        overflow: hidden;\n\n        .list-fixed {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            background: #f2f2f2;\n\n            .fixed-title {\n                height: 30px;\n                line-height: 30px;\n                padding-left: 10px;\n                background: #f2f2f2;\n            }\n        }\n\n        .title {\n            height: 30px;\n            line-height: 30px;\n            padding-left: 10px;\n            box-sizing: border-box;\n            background: #F2F2F2;\n        }\n\n        .button-list {\n            padding: 5px 30px 5px 5px;\n            display: flex;\n            justify-content: space-between;\n            box-sizing: border-box;\n            flex-wrap: wrap;\n\n            .button-warpper {\n                flex: 0 0 33.33%;\n\n                .button {\n                    text-align: center;\n                    padding: 5px 0;\n                    border-radius: 2.5px;\n                    border: 1px solid #ccc;\n                    margin: 5px;\n                }\n            }\n        }\n\n        .item-list {\n            .item {\n                height: 40px;\n                line-height: 40px;\n                padding-left: 10px;\n                font-size: 13px;\n                box-sizing: border-box;\n            }\n\n            &:last-child, &:after {\n                border: 0;\n            }\n        }\n    }\n\n    .search-content {\n        position: absolute;\n        overflow: hidden;\n        top: 83px;\n        bottom: 0;\n        right: 0;\n        left: 0;\n        z-index: 1;\n\n        ul {\n            li {\n                height: 40px;\n                line-height: 40px;\n                padding-left: 10px;\n                font-size: 13px;\n                box-sizing: border-box;\n            }\n        }\n\n        .noData {\n            text-align: center;\n            margin-top: 50px;\n            font-size: 14px;\n        }\n    }\n}\n</style>\n\n"]}]}